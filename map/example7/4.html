<!DOCTYPE html>
<html>
<head>
	<title>地图API－范例－获取覆盖物信息</title>
	<meta charset="UTF-8" />
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta tabindex="">
	<link rel="stylesheet" type="text/css" href="http://demo.ishowchina.com/apidemos/sourceLinks/style.css" />
	<script type="text/javascript" src="http://api.ishowchina.com/v4/webapi/js/auth?v=3.6.3&t=jsmap&ak=ec85d3648154874552835438ac6a02b2"></script>
	
</head>
<body>
	<div id="map"  class="map_contaner"></div>
	<div id="pannel" class="contro_panel_button contro_panel_button_br">
		<input type="button" class="button" value="获取折线长度" onclick="toggleGetLineLength()">
		<input id="line" type="text" class="text" size=10>&nbsp;
		<input type="button" class="button" value="获取多边形面积" onclick="toggleGetArea()">
		<input id="area" type="text" class="text" size=10>
	</div>
    <script type="text/javascript">
    	var map, polyline, polygon;
	    function initMap(){
	        map=new IMAP.Map("map", {
				minZoom:4,//最小地图级别
				maxZoom:18,//最大地图级别
				zoom:12,//初始化级别
				center:new IMAP.LngLat(116.40976,39.90131)//中心点坐标
	        });
	        toggleAddVector();
	    }
	    //添加覆盖物
	    function toggleAddVector() {
	    	if(map){
				var path='116.38504400000001,39.890383;116.398262,39.878136000000005;116.403411,39.889461000000004'.split(";");
				var lineLnglats  = [],lnglat;
				for(var i=0,len = path.length;i<len;i++){
					lnglat= path[i].split(",");
					lineLnglats.push(new IMAP.LngLat(lnglat[0],lnglat[1]));
				}
	    		polyline=new IMAP.Polyline(lineLnglats, {"strokeOpacity" : 1});
	    		map.getOverlayLayer().addOverlay(polyline, false);

				path='116.41946200000001,39.897215;116.426843,39.874515;116.405986,39.868325000000006'.split(";");
				var polygonLnglats  = [],len;
				for(var i=0,len = path.length;i<len;i++){
					lnglat= path[i].split(",");
					polygonLnglats.push(new IMAP.LngLat(lnglat[0],lnglat[1]));
				}
	    		polygon=new IMAP.Polygon(polygonLnglats, {"strokeOpacity" : 1});
	    		map.getOverlayLayer().addOverlay(polygon, false);
			}
	    }
	    //获取折线长度
	    function toggleGetLineLength() {
	    	if (polyline) {
	    		var linelength = polyline.getPathLength();
	    		document.getElementById("line").value=linelength+"米";
	    	}
	    }
	  	//获取多边形面积
	    function toggleGetArea() {
	    	if (polygon) {
	    		var area = polygon.getArea();
	    		document.getElementById("area").value=area.toFixed(2)+"平方公里";
	    	}
	    }
    	initMap(); 
    </script>
</body>
</html>