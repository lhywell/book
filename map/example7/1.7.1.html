<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="我秀地图" />
    <title>我秀地图－地图API－范例－画圆</title>
    <link rel="stylesheet" type="text/css" href="http://demo.ishowchina.com/apidemos/sourceLinks/style.css" />
    <script type="text/javascript" src="http://api.ishowchina.com/v4/webapi/js/auth?v=3.6.3&t=jsmap&ak=ec85d3648154874552835438ac6a02b2"></script>
    <script src="http://public.ishowchina.com/js/jquery-1.11.3.min.js"></script>
    <style type="text/css">

    </style>
</head>

<body>
    <div id="app">
        <div id="map" class="map_contaner"></div>
    </div>
</body>
<script type="text/javascript">
var map;



function initMap() {
    map = new IMAP.Map("map", {
        minZoom: 4, //最小地图级别
        maxZoom: 18, //最大地图级别
        zoom: 12, //初始化级别
        center: new IMAP.LngLat(116.40976, 39.90131) //中心点坐标
    });
    let lng = 121.39247625712484;
    let lat = 31.14096562528681;
    let range = 5000;

    let circle = drawCircle(121.39247625712484, 31.14096562528681,
        5000)
    console.log(circle.getId())
    var id = circle.getId();
    let lnglat = new IMAP.LngLat(lng, lat);
    let marker = drawMarker(lnglat);
    map.getOverlayLayer().addOverlays([marker, circle], true);
    // (function(){}())
    marker.addEventListener(IMAP.Constants.DBLCLICK, () => {
        var that = this;
        var content = '<div><input type="radio" name="switch">开</input> <input type="radio" name="switch">关</input></div><div><button class="ivu-btn ivu-btn-primary" onclick="(function(){}( '+console.log(this)+'deleteCover() ));">删除</button></div>';
        marker.openInfoWindow(content, {
            title: '',
            offset: new IMAP.Pixel(-5, -30),
            size: new IMAP.Size(250, 100)
        });

    }, marker);
}


function deleteCover() {
    console.log(1)
}


//添加点标注
function drawCircle(lng, lat, range) {
    var opts = new IMAP.CircleOptions();
    opts.fillColor = "#C6FACE";
    opts.fillOpacity = 0.5;
    opts.strokeColor = "#0FD62C";
    opts.strokeOpacity = 1;
    opts.strokeWeight = 3;
    opts.strokeStyle = "solid";
    let circle = new IMAP.Circle(new IMAP.LngLat(lng, lat), range, opts);
    return circle;
}

function drawMarker(lnglat) {
    let opts = new IMAP.MarkerOptions();
    opts.anchor = IMAP.Constants.BOTTOM_CENTER;
    opts.icon = new IMAP.Icon(IMAP.MapConfig.API_REALM_NAME + "images/point_1.png", {
        "size": new IMAP.Size(35, 30),
        "offset": new IMAP.Pixel(5, 0)
    });
    var marker = new IMAP.Marker(lnglat, opts);

    return marker;
}
initMap();
</script>

</html>