<!DOCTYPE html>
<html>

<head>
    <title>地图API－范例－经纬度查询</title>
    <meta charset="UTF-8" />
    <meta name="renderer" content="webkit">
    <link rel="stylesheet" type="text/css" href="http://demo.ishowchina.com/apidemos/sourceLinks/style.css" />
    <script type="text/javascript" src="http://api.ishowchina.com/v4/webapi/js/auth?v=3.6.3&t=jsmap&ak=ec85d3648154874552835438ac6a02b2"></script>
    <script src="http://public.ishowchina.com/js/jquery-1.11.3.min.js"></script>
    <style type="text/css">

    </style>
</head>

<body>
    <div id="map" class="map_contaner"></div>
    <div class="contro_panel contro_panel_position_ll contro_panel_height" style="width:200px;height:50px;overflow-y: inherit;">
        &nbsp;&nbsp;添加点标注：
        <div style="margin-left: 12px;margin-top: 4px;" class="clearfix">
            <input id="lng" type="text" placeholder="经度" class="text">
            <input id="lat" type="text" placeholder="纬度" class="text">
            <input type="button" class="button" id="add" value="添加" onclick="toggleAddMarker()">&nbsp;
        </div>
    </div>
</body>
<script type="text/javascript">
var map;

function initMap() {
    map = new IMAP.Map("map", {
        minZoom: 4, //最小地图级别
        maxZoom: 18, //最大地图级别
        zoom: 12, //初始化级别
        center: new IMAP.LngLat(116.40976, 39.90131) //中心点坐标
    });

    $('#add').click(function() {
        var lng = $('#lng').val();
        var lat = $('#lat').val();
        console.log(lng)
        toggleAddMarker(lng, lat)
    })
}

//添加点标注
function toggleAddMarker(lng, lat) {
    if (map) {
        var opts = new IMAP.MarkerOptions();
        opts.anchor = IMAP.Constants.BOTTOM_CENTER;
        opts.icon = new IMAP.Icon(IMAP.MapConfig.API_REALM_NAME + "images/point_1.png", { "size": new IMAP.Size(35, 30), "offset": new IMAP.Pixel(5, 0) });
        var lnglat = new IMAP.LngLat(lng, lat);
        if (lnglat) {
            marker = new IMAP.Marker(lnglat, opts);
            marker.setLabel('选中的当前围栏', {
                anchor: IMAP.Constants.RIGHT_TOP,
                offset: new IMAP.Pixel(-120, -50),
                title: 'label',
                fontSize: 12,
                fontColor: '#333333',
                borderColor: "red"
            })
            map.getOverlayLayer().addOverlay(marker, true);
        }
    }
}


initMap();
</script>

</html>