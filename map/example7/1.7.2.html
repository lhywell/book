<!DOCTYPE html>
<html>

<head>
    <title>地图API－范例－默认右键菜单</title>
    <meta charset="UTF-8" />
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta tabindex="">
    <link rel="stylesheet" type="text/css" href="http://demo.ishowchina.com/apidemos/sourceLinks/style.css" />
    <script type="text/javascript" src="http://api.ishowchina.com/v4/webapi/js/auth?v=3.6.3&t=jsmap&ak=ec85d3648154874552835438ac6a02b2"></script>
</head>

<body>
    <div id="map" class="map_contaner"></div>
    <div id="pannel" class="contro_panel contro_panel_position_lr contro_panel_height">
        请在地图上右键点击鼠标，查看默认样式右键菜单:)
    </div>
    <script type="text/javascript">
    var map;

    function initMap() {
        map = new IMAP.Map("map", {
            minZoom: 4, //最小地图级别
            maxZoom: 18, //最大地图级别
            zoom: 12, //初始化级别
            center: new IMAP.LngLat(116.40976, 39.90131) //中心点坐标
        });

        let lng = 121.39247625712484;
        let lat = 31.14096562528681;
        let range = 5000;

        let circle = drawCircle(lng, lat, 5000)
        console.log(circle.getId())
        var id = circle.getId();
        let lnglat = new IMAP.LngLat(lng, lat);
        let marker = drawMarker(lnglat);
        map.getOverlayLayer().addOverlays([marker, circle], true);

        contextmenu();
    }
    //添加默认右键菜单
    function contextmenu() {
        if (map) {
            var menu = new IMAP.ContextMenu(false);
            var item = new IMAP.MenuItem("以此点居中", { iconUrl: IMAP.MapConfig.API_REALM_NAME + "images/tpoi.png", iconSize: [14, 14] });
            item.setCallback(function(lnglat) {
                map.setCenter(lnglat);
            });
            menu.addItem(item);
            item = new IMAP.MenuItem("放大地图");
            item.setCallback(function(lnglat) {
                map.zoomIn(lnglat);
            });
            menu.addItem(item);
            item = new IMAP.MenuItem("缩小地图");
            item.setCallback(function(lnglat) {
                map.zoomOut(lnglat);
            });
            menu.addItem(item);
            menu.addSeparator(0);
            map.addContextMenu(menu);
        }
    }
    initMap();
    //添加点标注
    function drawCircle(lng, lat, range) {
        var opts = new IMAP.CircleOptions();
        opts.fillColor = "#C6FACE";
        opts.fillOpacity = 0.5;
        opts.strokeColor = "#0FD62C";
        opts.strokeOpacity = 1;
        opts.strokeWeight = 3;
        opts.strokeStyle = "solid";
        let circle = new IMAP.Circle(new IMAP.LngLat(lng, lat), range, opts);
        return circle;
    }

    function drawMarker(lnglat) {
        let opts = new IMAP.MarkerOptions();
        opts.anchor = IMAP.Constants.BOTTOM_CENTER;
        opts.icon = new IMAP.Icon(IMAP.MapConfig.API_REALM_NAME + "images/point_1.png", {
            "size": new IMAP.Size(35, 30),
            "offset": new IMAP.Pixel(5, 0)
        });
        var marker = new IMAP.Marker(lnglat, opts);

        return marker;
    }
    </script>
</body>

</html>